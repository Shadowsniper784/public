{"ast":null,"code":"\"use strict\";import _regeneratorRuntime from\"/home/runner/public/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/runner/public/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/runner/public/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function get(){return m[k];}});}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,\"default\",{enumerable:true,value:v});}:function(o,v){o[\"default\"]=v;});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod){if(k!==\"default\"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);}__setModuleDefault(result,mod);return result;};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{\"default\":mod};};Object.defineProperty(exports,\"__esModule\",{value:true});var React=__importStar(require(\"react\"));var react_router_dom_1=require(\"react-router-dom\");var Menu_1=require(\"./components/Menu\");var Sidebar_1=require(\"./components/Sidebar\");var Dashboard_1=require(\"./pages/Dashboard\");var GuildContext_1=require(\"./utils/contexts/GuildContext\");var GuildStoreContext_1=require(\"./utils/contexts/GuildStoreContext\");var axios_1=__importDefault(require(\"axios\"));function App(){var _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),guild=_React$useState2[0],setGuild=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),guilds=_React$useState4[0],setGuilds=_React$useState4[1];var _React$useState5=React.useState(),_React$useState6=_slicedToArray(_React$useState5,2),token=_React$useState6[0],setToken=_React$useState6[1];var history=(0,react_router_dom_1.useHistory)();//const { loading, error } = useQuery(getUser, {\n// onCompleted: ({ getUser }) => {\n//   const { guilds } = getUser;\n//     setGuilds(guilds);\n//   },\n// });\n// console.log(error);\n// if (loading) return <h1>Loading</h1>;\n// if (error) return <h1>You are making too many requests.</h1>;\nReact.useEffect(function(){function run(){return _run.apply(this,arguments);}function _run(){_run=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var inst,search,query,data,_data,servers;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:inst=axios_1.default.create({baseURL:'https://public.shadowsniper784.repl.co'});search=window.location.search;query=new URLSearchParams(search);if(!(query.has('code')||window.localStorage.getItem('access_token')&&window.localStorage.getItem('refresh_on')&&Math.round(Date.now()/1000)<parseInt(window.localStorage.getItem('refresh_on'))||window.localStorage.getItem('refresh_token'))){_context.next=39;break;}if(!(window.localStorage.getItem('access_token')&&window.localStorage.getItem('refresh_on')&&Date.now()<parseInt(window.localStorage.getItem('refresh_on')))){_context.next=9;break;}console.log('No request needed access token: %s',window.localStorage.getItem('access_token'));setToken(window.localStorage.getItem('access_token'));_context.next=31;break;case 9:if(!localStorage.getItem('refresh_token')){_context.next=20;break;}_context.next=12;return axios_1.default.post('/api/refresh',{refresh_token:window.localStorage.getItem('refresh_token')});case 12:data=_context.sent;console.log('Request now %o',data);data=data.data;window.localStorage.setItem('access_token',data.access_token);window.localStorage.setItem('refresh_on',data.refresh_on);setToken(data.access_token);_context.next=31;break;case 20:if(!query.has('code')){_context.next=31;break;}console.log('Has code: %s',query.get('code'));_context.next=24;return axios_1.default.get('/api/access',{params:{code:query.get('code')}});case 24:_data=_context.sent;console.log('Request finished: %o',_data);_data=_data.data;window.localStorage.setItem('access_token',_data.access_token);window.localStorage.setItem('refresh_on',_data.refresh_on);window.localStorage.setItem('refresh_token',_data.refresh_token);setToken(_data.access_token);case 31:console.log('Getting guilds: %s',window.localStorage.getItem('access_token'));_context.next=34;return axios_1.default.post('/api/guilds',{access_token:window.localStorage.getItem('access_token')});case 34:servers=_context.sent;console.log('Request finished: %o',servers);setGuilds(servers.data);_context.next=40;break;case 39:window.location.href='https://public.shadowsniper784.repl.co/api/login';//  setGuilds([])\ncase 40:case\"end\":return _context.stop();}}},_callee);}));return _run.apply(this,arguments);}run();},[]);return/*#__PURE__*/_jsxs(Providers,{guild:guild,setGuild:setGuild,guilds:guilds,setGuilds:setGuilds,children:[/*#__PURE__*/_jsx(Sidebar_1.Sidebar,{guilds:guilds,history:history}),/*#__PURE__*/_jsx(Menu_1.Menu,{title:guild?guild.name:'Shadow Public',history:history}),/*#__PURE__*/_jsx(Routes,{})]});}function Providers(_ref){var children=_ref.children,guild=_ref.guild,setGuild=_ref.setGuild,guilds=_ref.guilds,setGuilds=_ref.setGuilds;return/*#__PURE__*/_jsx(GuildContext_1.GuildContextProvider,{value:{guild:guild,setGuild:setGuild},children:/*#__PURE__*/_jsx(GuildStoreContext_1.GuildStoreContextProvider,{value:{guilds:guilds,setGuilds:setGuilds},children:children})});}function Routes(){return/*#__PURE__*/_jsxs(react_router_dom_1.Switch,{children:[/*#__PURE__*/_jsx(react_router_dom_1.Route,{path:\"/\",exact:true,component:Dashboard_1.DashboardPage}),/*#__PURE__*/_jsx(react_router_dom_1.Route,{path:\"/dashboard/:guildId\",exact:true,component:Dashboard_1.DashboardPage}),/*#__PURE__*/_jsx(react_router_dom_1.Route,{path:\"/dashboard/:guildId/general/muted\",exact:true,component:Dashboard_1.DashboardPage})]});}exports.default=App;","map":{"version":3,"sources":["/home/runner/public/dashboard/src/App.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","prototype","hasOwnProperty","call","__importDefault","exports","React","require","react_router_dom_1","Menu_1","Sidebar_1","Dashboard_1","GuildContext_1","GuildStoreContext_1","axios_1","App","useState","guild","setGuild","guilds","setGuilds","token","setToken","history","useHistory","useEffect","run","inst","default","baseURL","search","window","location","query","URLSearchParams","has","localStorage","getItem","Math","round","Date","now","parseInt","console","log","post","refresh_token","data","setItem","access_token","refresh_on","params","code","servers","href","name","Providers","children","Routes","DashboardPage"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = __importStar(require(\"react\"));\nconst react_router_dom_1 = require(\"react-router-dom\");\nconst Menu_1 = require(\"./components/Menu\");\nconst Sidebar_1 = require(\"./components/Sidebar\");\nconst Dashboard_1 = require(\"./pages/Dashboard\");\nconst GuildContext_1 = require(\"./utils/contexts/GuildContext\");\nconst GuildStoreContext_1 = require(\"./utils/contexts/GuildStoreContext\");\nconst axios_1 = __importDefault(require(\"axios\"));\nfunction App() {\n    const [guild, setGuild] = React.useState();\n    const [guilds, setGuilds] = React.useState([]);\n    const [token, setToken] = React.useState();\n    const history = (0, react_router_dom_1.useHistory)();\n    //const { loading, error } = useQuery(getUser, {\n    // onCompleted: ({ getUser }) => {\n    //   const { guilds } = getUser;\n    //     setGuilds(guilds);\n    //   },\n    // });\n    // console.log(error);\n    // if (loading) return <h1>Loading</h1>;\n    // if (error) return <h1>You are making too many requests.</h1>;\n    React.useEffect(() => {\n        async function run() {\n            const inst = axios_1.default.create({\n                baseURL: 'https://public.shadowsniper784.repl.co'\n            });\n            let search = window.location.search;\n            let query = new URLSearchParams(search);\n            if (query.has('code') ||\n                (window.localStorage.getItem('access_token') &&\n                    window.localStorage.getItem('refresh_on') &&\n                    Math.round(Date.now() / 1000) < parseInt(window.localStorage.getItem('refresh_on'))) ||\n                window.localStorage.getItem('refresh_token')) {\n                if (window.localStorage.getItem('access_token') && window.localStorage.getItem('refresh_on') && Date.now() < parseInt(window.localStorage.getItem('refresh_on'))) {\n                    console.log('No request needed access token: %s', window.localStorage.getItem('access_token'));\n                    setToken(window.localStorage.getItem('access_token'));\n                }\n                else if (localStorage.getItem('refresh_token')) {\n                    let data = await axios_1.default.post('/api/refresh', {\n                        refresh_token: window.localStorage.getItem('refresh_token')\n                    });\n                    console.log('Request now %o', data);\n                    data = data.data;\n                    window.localStorage.setItem('access_token', data.access_token);\n                    window.localStorage.setItem('refresh_on', data.refresh_on);\n                    setToken(data.access_token);\n                }\n                else if (query.has('code')) {\n                    console.log('Has code: %s', query.get('code'));\n                    let data = await axios_1.default.get('/api/access', {\n                        params: {\n                            code: query.get('code')\n                        }\n                    });\n                    console.log('Request finished: %o', data);\n                    data = data.data;\n                    window.localStorage.setItem('access_token', data.access_token);\n                    window.localStorage.setItem('refresh_on', data.refresh_on);\n                    window.localStorage.setItem('refresh_token', data.refresh_token);\n                    setToken(data.access_token);\n                }\n                console.log('Getting guilds: %s', window.localStorage.getItem('access_token'));\n                let servers = await axios_1.default.post('/api/guilds', { access_token: window.localStorage.getItem('access_token') });\n                console.log('Request finished: %o', servers);\n                setGuilds(servers.data);\n            }\n            else {\n                window.location.href = 'https://public.shadowsniper784.repl.co/api/login';\n                //  setGuilds([])\n            }\n        }\n        run();\n    }, []);\n    return (<Providers guild={guild} setGuild={setGuild} guilds={guilds} setGuilds={setGuilds}>\n      <Sidebar_1.Sidebar guilds={guilds} history={history}/>\n      <Menu_1.Menu title={guild ? guild.name : 'Shadow Public'} history={history}/>\n      <Routes />\n    </Providers>);\n}\nfunction Providers({ children, guild, setGuild, guilds, setGuilds }) {\n    return (<GuildContext_1.GuildContextProvider value={{ guild, setGuild }}>\n      <GuildStoreContext_1.GuildStoreContextProvider value={{ guilds, setGuilds }}>\n        {children}\n      </GuildStoreContext_1.GuildStoreContextProvider>\n    </GuildContext_1.GuildContextProvider>);\n}\nfunction Routes() {\n    return (<react_router_dom_1.Switch>\n      <react_router_dom_1.Route path=\"/\" exact={true} component={Dashboard_1.DashboardPage}/>\n      <react_router_dom_1.Route path=\"/dashboard/:guildId\" exact={true} component={Dashboard_1.DashboardPage}/>\n      <react_router_dom_1.Route path=\"/dashboard/:guildId/general/muted\" exact={true} component={Dashboard_1.DashboardPage}/>\n    </react_router_dom_1.Switch>);\n}\nexports.default = App;\n"]},"metadata":{},"sourceType":"module"}